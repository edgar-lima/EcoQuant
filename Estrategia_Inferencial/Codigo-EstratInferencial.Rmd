---
title: "Estratégias Inferenciais"
author: "Edgar Luiz de Lima"
date: "11/03/2022"
output:
  pdf_document: default
  html_document: default
---

# Dados
  O conjunto de dados que iremos utilizar foi retirado de um conjuto de dados muito maior de Mazerolle & Desrochers (2005).
  
  Ele apresenta as seguintes variáveis:
  
  1. Shade: variável binária indicando se o indivíduo foi coletado na sombra(1= sim, 0= não).
  2. Cloud: cobertura de núvem expressa em porcentagem.
  3. Airtemp: temperatura do ar em graus celcius.
  4. Mass_lost: perda de massa corporal em gramas.

1. Aqui iremos definir o diretório, carregar os pacotes e o banco de dados.
```{r}
library(MuMIn)
library(openxlsx)
dados<- read.xlsx("Dados.xlsx")
```

1.2. Vamos visualizar as 10 primeiras linhas do conjunto de dados.
```{r}
head(dados, 10)
```

1.3. Agora precisamos checar como o formato em que o R leu os dados, para saber se os dados estão no formato correto.
```{r}
str(dados)
```
Podemos ver que a variável Shade está sendo interpretada como variável numérica, mas na verdade ela deve ser interpretatada como uma variável categórica.

Então vamos converter ela em fator, e depois checar se ela realmente foi interpretada como fator.
```{r}
dados$Shade<- as.factor(dados$Shade)
str(dados)
```
Agora o R está interpretando ela como fator, e está nos dizendo que ela possui os níveis 0 e 1, que significam não estar na sombra e estar na sombra respectavamente.

# Testando as nossas hipóteses

  Antes de testar as nossas hipoteses precisamos entender primeiro como descrevemos o nosso modelo estatístico no R. Para isso utilizamos o a função lm() que significar linear model, e especificamos o noss modelo da seguinte maneira.
  
               lm(y~x, data) 

  onde:
  1. y= é a variável resposta, nesse caso Mass_lost;
  2. x= é a variável preditora, no nosso caso teremos três variáveis preditoras;
  3. data= é o conjunto de dados que as minhas variáveis fazem parte.
  4. til(~)= significa em função de, ou seha, minha variável resposta em função das variáveis preditoras.



## 1. Teste de significancia da hipótese nula (NHST)

1.1 Primeiramente, temos que especificar o nosso modelo.
  Então,especificaremos o nosso modelo da seguinte maneira, Mass_lost em função de Airtemp,Cloud e Shade. E indicamos que as variáveis está dento do conjunto de dados chamada dados.
```{r}
nhst<- lm(Mass_lost~Airtemp+Cloud+Shade, data = dados)
nhst
```
  Pronto, o modelo já foi ajustado, podemos ler o ajuste do modelo da seguinte forma:
  
  1. Intercep= média da Mass_loss para os indivíduos que não está na sombra.
  2. Airtemp= é o tamanho de efeito(a1) da Airtemp sobre a Mass_loss (aqui o tamanho de efeito é representado pelo coeficiente de inclinação da reta).
  3. Clound= é o tamanho de efeito(a1) da Cloud sobre a Mass_loss.
  4. Shade1= é o tamanho de efeito da variável Shade sobre o Mass_loss, ou seja, é a diferença entre as médias de Mass_loss no tratamento 1 e 0.
  
  Podemos obter o valor da média de Mass_loss no tratamento shade1 subtraindo do intercept o valor do tamanho de efeito.
```{r}
coefi<- nhst$coefficients
coefi[1]-abs(coefi[4])
```
  Podemos observar então que o valor da média de Mass_loss em Shade1 que são aqueles indivíduos coletados em ambiente sombreado é igual a 1.631833

  1.2. Agora vamos verificar o valor de p para saber se iremos rejeitar a hipótese nula.
```{r}
summary(nhst)
```
Nesse caso então, rejeitamos a hipótese nula e aceitamos a hipótese alternativa, e de acordo com os nossas resultados, há diferença na perda de massa corporal entre indivíduos que estão na sombra e indivíduos que não estão na sombra. Sendo que indivíduos que não estão na sombra perdem 0.789 gramas a mais que os indivídos que estão na sombra.

## 2. Intervalo de confiança
```{r}
intconf<- lm(Mass_lost~Airtemp+Cloud+Shade, data = dados)
confint.lm(object = intconf)
coef(intconf)
```

Selecao de modelos
```{r}
comp<-lm(Mass_lost~Airtemp+Cloud+Shade, data = dados)
tempcl<-lm(Mass_lost~Airtemp+Cloud, data = dados)
tempsh<-lm(Mass_lost~Airtemp+Shade, data = dados)

contraste<- model.sel(comp,tempcl, tempsh)
contraste<-contraste[,c(6:10)]
contraste
```

